<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Institute for Machine Learning @ JKU | GyroSwin: 5D Surrogates for Gyrokinetic Plasma Turbulence Simulations</title>
<meta name="description" content="Research blog of the Institute for Machine Learning @ JKU.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/blog/2025/gyroswin/">

<!-- Theming-->



  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-KC0VGMCD6W"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-KC0VGMCD6W');
  </script>


    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
      <a class="navbar-brand title font-weight-lighter" href="ml-jku.github.io/">
       <!-- <span>Institute</span> for Machine  Learning @ JKU -->
       <img class="rounded" src="/assets/img/jku_ml_1.svg" width=100px height=45px>
       <img class="rounded" src="/assets/img/ellis_linz.jpeg" width=200px height=45px>
      </a>
    <div class="container">
      
      <!-- Navbar Toogle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
                
                    <div class="dropdown">
                      <a class="nav-link" href="/research/">
                        research
                        
                      </a>
                        <div class="dropdown-content">
                          <a href="/research/deep_learning">Deep Learning</a>
                          <a href="/research/ai_healthcare">AI in Health Care</a>
                          <a href="/research/ai_drug">AI in Drug Discovery</a>
                          <a href="/research/reinforcement_learning">Reinforcement Learning</a>
                          <a href="/research/hopfield_networks">Modern Hopfield Networks</a>
                          <a href="/research/ai4earth">AI 4 Earth</a>
                          <a href="/research/ai4drive">AI 4 Driving</a>
                        </div>
                      </div>
                    
                
          </li>
          
          
          
          
          
          
          
          <li class="nav-item ">
                
                <a class="nav-link" href="/publications/">
                  publications
                  
                </a>
                
          </li>
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
                
                <a class="nav-link" href="/talks/">
                  talks
                  
                </a>
                
          </li>
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="https://www.jku.at/en/institute-for-machine-learning/about-us/team/" target="_blank" rel="noopener noreferrer">
                people
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
                
                <a class="nav-link" href="/software/">
                  software
                  
                </a>
                
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="https://www.jku.at/en/institute-for-machine-learning/" target="_blank" rel="noopener noreferrer">
                contact
                
              </a>
          </li>
          
          
          
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">GyroSwin: 5D Surrogates for Gyrokinetic Plasma Turbulence Simulations</h1>
    <p class="post-meta">October 13, 2025</p>
  </header>

  <article class="post-content">
    <hr />

<div style="text-align: center;">
  <a href="https://github.com/ml-jku/neural-gyrokinetics" target="_blank">
    <img src="https://img.shields.io/badge/GitHub-181717?style=for-the-badge&amp;logo=GitHub&amp;logoColor=FFFFFF" alt="code" />
  </a>
  &nbsp;&nbsp;
  <a href="https://arxiv.org/abs/2510.07314" target="_blank">
    <img src="https://img.shields.io/badge/arXiv-B31B1B?style=for-the-badge&amp;logo=arXiv&amp;logoColor=FFFFFF" alt="paper" />
  </a>
</div>

<hr />

<figure style="text-align: center;">
    <img src="/assets/img/gyroswin/velocity_surfaces.gif" alt="5d distribution function" width="70%" />
    <figcaption style="color: black; font-size: 14px; margin-top: 8px;">
    Figure 1: Visualizing the 5D distribution function, as 3D toruses within the 2D velocity space.
    </figcaption>
</figure>

<h2 id="tldr">TL;DR</h2>
<div style="border-left: 4px solid #5e4931ff; background-color: #e8cfcfff; padding: 12px 16px; margin: 1em 0; border-radius: 4px;">
<strong>Nuclear fusion is hard</strong>, as it requires understanding physical phenomena like plasma turbulence. One way to do this is with very expensive <strong>numerical simulations, called gyrokinetics</strong>. We propose <img src="/assets/img/gyroswin/gyroswin_icon.png" alt="GyroSwin Icon" height="12px" /> <strong>GyroSwin</strong>, a neural surrogate model based on <strong>swin transformers</strong> for nonlinear gyrokinetic equations, which models Plasma turbulence in a <strong>5D phase space</strong>, unlike existing methods which take reduced approaches, and offers a <strong>&gt;1000x speedup</strong> compared to numerical gyrokinetics solvers.
</div>

<h2 id="introduction">Introduction</h2>

<p>Nuclear Fusion is a promising contender for sustainable energy production. For humans, we can use the energy released by the reaction of fusing two hydrogen atoms (to form helium and a neutron, where most energy ends up) to power, for example, a turbine. In nature, fusion naturally occurs in stars, where the strong gravitational force produces massive pressures which overcome the repelling force between two hydrogen atoms (<em>Coulomb barrier</em>). The figure below shows the fusion reaction for hydrogen isotopes Deutereum and Tritium.</p>

<figure style="text-align: center;">
    <img src="/assets/img/gyroswin/dt_fusion.gif" alt="D-T nuclear fusion reaction" width="70%" />
    <figcaption style="color: black; font-size: 14px; margin-top: 8px;">
    Figure 2: Animated deuterium-tritium nuclear fusion. Source: <a href="https://commons.wikimedia.org/wiki/File:Animated_D-T_fusion.gif">wikimedia.org</a>
    </figcaption>
</figure>

<p>Since the gravitational force on planet Earth is insufficient to overcome this barrier, we require massive amounts of heat to increase the probability of atoms fusing. In reality, this means heating up a gas to hundreds of millions of degrees, which is also called a <strong>Plasma</strong>. At these conditions, hydrogen atoms split into ions and electrons. Due the amount of heat, the Plasma has to be confined within magnetic fields, as there is no material that could withstand such extreme temperatures.</p>

<p>To turn nuclar fusion into a viable energy source, Plasma needs to be confined over long periods of time. This is difficult, as it’s inherently unstable, and often tries to escape confinement. One contributor to this behavior is <strong>turbulence</strong>, which arises due to temperature gradients within the Plasma. Therefore it is essential to understand and model Plasma turbulence in modern reactors such as Tokamaks, in order to downstream design new reactors and confinement control systems.
However, understanding and modelling Plasma turbulence is an incredibly hard problem, and practictioners must rely on expensive numerical simulations.</p>

<blockquote>
  <p><em>“Nuclear fusion is not rocket science, because it’s way harder.”</em><br />
— <em>William Hornsby</em></p>
</blockquote>

<p>Because it promises <strong>sustainable, safe, and relatively affordable energy</strong>, <strong>nuclear fusion</strong> remains a key focus in the pursuit of securing our <strong>future energy supply.</strong></p>

<h2 id="the-problem">The Problem</h2>

<p>Understanding <strong>plasma turbulence</strong> is crucial for modelling plasma scenarios for confinement control and reactor design. Numerically, Plasma turbulence is governed by the <strong>nonlinear gyrokinetic equation</strong>, which evolves a <strong>5D distribution function</strong> over time <strong>in phase space</strong>.</p>

<p>Let \(f = f(x, y, s, v_{\parallel}, \mu)\) where:</p>

<ul>
  <li>\(x\), \(y\) are spatial coordinates along a toroidal C-section of a torus in real space.</li>
  <li>\(s\) is the toroidal coordinate along the field line, going around the torus.</li>
  <li>\(v_{\parallel}\) the parallel velocity component along the field lines.</li>
  <li>\(\mu\) is the magnetic angular moment, related to the gyral motion of particles.</li>
</ul>

<p>The time-evolution of the perturbed distribution \(f\)
, usually called \(\delta f\), is governed by the gyrokinetic equation [<a href="#ref-gyrokinetics">5</a>, <a href="#ref-gyrokinetics2">6</a>, <a href="#ref-gyrokinetics3">7</a>], a reduced form of the Vlasov-Maxwell PDE system</p>

\[\frac{\partial f}{\partial t} + (v_\parallel \mathbf{b} + \mathbf{v}_D) \cdot \nabla f -\frac{\mu B}{m} \frac{\mathbf{B} \cdot \nabla B}{B^2} \frac{\partial f}{\partial v_\parallel} + \mathbf{v}_\chi \cdot \nabla f = S\]

<p>Where:</p>

<ul>
  <li>\(v_{\parallel} \mathbf{b}\) is the motion along magnetic field lines.</li>
  <li>\(\mathbf{b} = \mathbf{B} / B\) is the unit vector along the magnetic field \(\mathbf{B}\) with magnitude \(B\).</li>
  <li>\(\mathbf{v}_D\) is the magnetic drift due to gradients and curvature in \(\mathbf{B}\).</li>
  <li>\(\mathbf{v}_\chi\) describes nonlinear drifts arising from crossing electric and magnetic fields.</li>
  <li>\(S\) is the source term that represents collisions between particles.</li>
</ul>

<p>The <strong>nonlinear term</strong> \(\mathbf{v}_\chi \cdot \nabla f\) describes turbulent advection, and the resulting nonlinear coupling constitutes the computationally most expensive term. For more details on gyrokinetics and the derivation of the equation, check <em>“The non-linear gyro-kinetic flux tube code GKW</em>” from <em>Arthur Peeters et al.</em> [<a href="#ref-gyrokinetics">5</a>] and <em>“Gyrokinetics</em>” by <em>Xavier Gerbet and Maxime Lesur</em> [<a href="#ref-gyrokinetics3">6</a>].</p>

<div style="border-left: 4px solid #5e4931ff; background-color: #e8cfcfff; padding: 12px 16px; margin: 1em 0; border-radius: 4px;">
    The phase-space distribution function (<strong>Eulerian</strong>) is not the only way gyrokinetics can be parametrized. Instead, we can describe it with an ensemble of trajectories governed by an SDE, where gyrocenters are tracked directly as particles (<strong>Lagrangian</strong>). With the Lagrangian approach, the distribution function can then be recovered from by sampling many gyro-paths (particle-in-cell methods, [<a href="#ref-pic">8</a>]). 
    <strong>Both frames are physically equivalent, but offer different insights and numerical advantages</strong>. <br /><br />
    This duality is related to the <strong><a href="https://en.wikipedia.org/wiki/Fokker%E2%80%93Planck_equation">Fokker-Planck equation</a></strong> [<a href="#ref-fokker">9</a>], which describes the evolution of probability densities under drift and diffusion. The Fokker-Planck equation is derived from an SDE, such as the <a href="https://en.wikipedia.org/wiki/Ornstein%E2%80%93Uhlenbeck_process">Ornstein–Uhlenbeck process</a> (as the forward Kolmogorov), and so it links the distribution-based and SDE-based descriptions.
    <!-- It is also connected to how collisions are modeled in gyrokinetics, with the Vlasov-Fokker-Planck equation.<br><br> -->
</div>

<p>Fully resolved gyrokinetics simulations are prohibitively expensive and often times practitioners need to rely on <strong>reduced order models</strong>, such as quasilinear models (for example QuaLiKiz [<a href="#ref-qualikiz">10</a>]). QL models are fast but severely limited in generalization and accuracy, as they entirely neglect the nonlinear term \(\mathbf{v}_\chi \cdot \nabla f\). However, machine learning (neural) surrogate models have the potential to overcome this limitation if we develop methodologies that can cope with the complex nature of 5D data.</p>

<h2 id="our-approach">Our Approach</h2>

<p>Our intuition is that <strong>modeling the entire 5D distribution function is vital</strong> to accurately model and comprehend turbulence in Plasmas.
Therefore we require techniques that can process 5D data. The classic repertoire of an ML engineer comprises a variety of different techniques. Let’s break it down whether there are suitable to proccess 5D data.</p>

<ul>
  <li><strong>Convolutions?</strong> There is no out-of-the-box convolution kernel for &gt;3D, so they need to be implemented either directly, recursively, or in a factorized manner. Regardless, convolutions become expensive and memory-intensive. [<a href="#ref-cnn">11</a>]</li>
  <li><strong>Transformers?</strong> ViTs can be applied to any number of dimension (provided proper patching / unpatching layers), but their quadratic scaling makes them unfeasible in our 5D setting due to quickly growing sequence lengths. [<a href="#ref-attention">12</a>, <a href="#ref-vit">13</a>]</li>
  <li><strong>Linear Attention?</strong> Vision Transformers with linear attention such as the Shifted Window Transformer (swin) [<a href="#ref-swin">14</a>] overcome quadratic scaling by performing attention locally in a simple way, making them an handy candidate for our case. However, to date, no implementation of swin Transformer exists that can process 5D data.</li>
</ul>

<p><strong> <span>↪</span> </strong> There is no architecture out there that can natively handle 5D inputs. <strong><em>So, now what?</em></strong></p>

<p>We generalize the local window attention mechanism used in Swin Transformers, together with patch merging and unpatching layers, to n-dimensional inputs. To this end, we generalize the (patch and window) partitioning strategy used in these layers to be able to process inputs of arbitrary dimensionalities. A standalone implementation of our n-dimensional swin layers can be found <a href="https://github.com/gerkone/ndswin">on github</a>. The figure below provides an illustration on how we extend (shifted) window attention to n dimensions.</p>

<figure style="text-align: center;">
    <img src="/assets/img/gyroswin/archv2.png" alt="nD swin attention in the 5D case" width="100%" />
    <figcaption style="color: black; font-size: 14px; margin-top: 8px;">
    Figure 3: Shifted window attention in the 2D (image), 3D (video), and 5D (our) case. In a layer, attention is performed locally only within components with the same color.
    </figcaption>
</figure>

<p>We propose Gyrokinetic Swin, <img src="/assets/img/gyroswin/gyroswin_icon.png" alt="GyroSwin Icon" height="12px" /> <strong>GyroSwin</strong>, the first ever neural surrogate for nonlinear Gyrokinetic simulations. We start from the popular UNet architecture [<a href="#ref-unet">15</a>] and model the temporal evolution of the distribution function in an autoregressive manner. Furthermore, GyroSwin is a multitask model and not only predicts the evolution of the 5D distribution function, but also 3D potential fields and heat flux, which are usually obtained by performing complex integrals on the 5D fields. GyroSwin achieves this through three output branches at different dimensions whose latents communicate via cross attention.</p>

<figure style="text-align: center;">
    <img src="/assets/img/gyroswin/figure1.png" alt="GyroSwin architecture compared to quasilinear" width="80%" />
    <figcaption style="color: black; font-size: 14px; margin-top: 8px;">
    Figure 4: GyroSwin multitask trainin pipeline. We directly model the 5D distribution function of nonlinear gyrokinetics and incorporates 3D electrostatic potential fields and turbulent transport quantities, such as heat flux.
    </figcaption>
</figure>

<h2 id="experiments">Experiments</h2>

<h5 id="data-generation">Data Generation</h5>

<p>To explore how turbulence evolves under different plasma conditions, we ran a large series of nonlinear simulations using the GKW code. In each run, we varied the noise level of the initial conditions and four key operating parameters: the safety factor (\(q\)), magnetic shear (\(\hat{s}\)), ion temperature gradient (\(R/L_t\)), and density gradient (\(R/L_n\)).</p>

<p>Because these simulations are computationally expensive, we simplified the setup using the adiabatic electron approximation. This allowed us to focus on turbulence driven primarily by ion temperature gradients, while keeping a reasonably fine spatial resolution of (32 × 8 × 16 × 85 × 32).</p>

<p>In total, we generated 255 simulations. From these, we built two main training sets: a smaller one with 48 simulations for comparing baseline methods, and a larger one with 241 simulations for scaling studies. Altogether, this produced 44,585 training samples, including 8,880 from the smaller subset.</p>

<h5 id="baselines">Baselines</h5>

<p>The general landscape of surrogate models for gyrokinetics can be classified into <strong>tabular regressors</strong>, <strong>reduced-numerical models</strong>, and <strong>neural surrogates</strong>. Each of those have different characteristics and capabilities, as seen in the table below. For example, neural surrogates operating in 5D can model heat flux, can be used to compute diagnostics, model zonal flows, and turbulence itself. Reduced numerics can only be used for flux prediction and diagnostics. Finally, tabular regressors map operating parameters to heat flux.</p>

<p><br /></p>

<table>
  <thead>
    <tr>
      <th><strong>Method</strong></th>
      <th><strong>Average Flux</strong></th>
      <th><strong>Diagnostics</strong></th>
      <th><strong>Zonal Flows</strong></th>
      <th><strong>Turbulence</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Tabular Regressors (e.g., GPR, MLP)</td>
      <td>✅ <strong>1D → 0D</strong></td>
      <td>❌</td>
      <td>❌</td>
      <td>❌</td>
    </tr>
    <tr>
      <td>SOTA Reduced Numerical Modelling (e.g., QL)</td>
      <td>✅ <strong>3D → 0D</strong></td>
      <td>✅ <strong>3D → 1D</strong></td>
      <td>❌</td>
      <td>❌</td>
    </tr>
    <tr>
      <td>Neural Surrogates (e.g., GyroSwin)</td>
      <td>✅ <strong>5D → 0D</strong></td>
      <td>✅ <strong>5D → 1D</strong></td>
      <td>✅ <strong>5D → 1D</strong></td>
      <td>✅ <strong>5D → 5D</strong></td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h5 id="evaluation">Evaluation</h5>

<p>The key promise of our method is that it can step in where reduced numerical models fall short. Unlike QL approaches, which rely on simplified physics, our model is trained directly on the full 5D distribution function, capturing much richer dynamics, while remaining efficient and scalable.</p>

<p>To truly test whether our model delivers better performance than QL models, we conducted data collection in a regime dominated by strong ion temperature gradients. This ensures that the simulations reflect a high-turbulence environment, pushing both models to their limits.</p>

<p>Out of the 255 total simulations, we set aside 14 for evaluating how well the model generalizes. These are split into in-distribution (ID) and out-of-distribution (OOD) test cases.</p>

<p>For the ID set, we selected simulations that appear within the convex hull of the operating parameter space covered by training, but that the model hasn’t seen before. The OOD set is outside that convex region, forcing the model to make predictions in unfamiliar territory.</p>

<p>In total, we used six simulations for the ID evaluation and five for the OOD. The remaining three simulations served as a validation set during training. Importantly, none of these were ever part of the training data, ensuring that our evaluation truly reflects the model’s ability to generalize beyond what it has learned.</p>

<h2 id="results">Results</h2>

<p>For comparison to other surrogate approaches we use the smaller training set as training on the larger set is very expensive and, as we will show, most of the baselines do not scale too well.</p>

<p><strong>5D\(\rightarrow\)5D Turbulence Modelling</strong> As a first result we quantify how well different methods capture turbulence and how stable they are during autoregressive rollouts in the table below. We quantified this stability using <em>correlation time</em> (CT), which measures how many consecutive snapshots the model can accurately predict while maintaining a certain level of Pearson correlation (denoted by \(\tau\)) with the true simulation data. The longer the correlation time, the better the model is at maintaining consistency over time. In the table below we report results for \(\tau=0.1\). When we compared different neural surrogate models, one result stood out clearly: our method was by far the most stable in autoregressive rollouts. Even more impressive, when we scaled up both the dataset size and the model itself, it achieved stable predictions for over 100 timesteps — and that held true even for OOD simulations that the model had never seen before.</p>

<p><strong>5D\(\rightarrow\)0D Average flux prediction</strong> In this experiment, the goal was to predict the average heat flux (\(\bar{Q}\)) during the final phase of each simulation (over the last 80 timesteps) using 5D snapshots produced after an autoregressive rollout. On the smaller training set, our method clearly outperformed both the traditional quasilinear (QL) model and other 5D neural surrogates. Interestingly, many of the competing neural models tended to converge toward similar predicted values of heat flux. This happens because of error accumulation — as predictions become noisier over time, the computed average heat flux tends to rise artificially. In fact, if the predictions were completely random, we would see \(\bar{Q}\) values exceeding 1000, illustrating just how strongly error buildup can inflate the results.</p>

<p>What’s particularly exciting is that when we scale our method — training it on more data and using a larger model — the improvement is dramatic. The predictions become far more accurate, and the model achieves substantially lower error than any of the existing surrogate approaches.</p>

<p><br /></p>

<table>
  <thead>
    <tr>
      <th><strong>Method</strong></th>
      <th><strong>Input</strong></th>
      <th><strong>CT ID (\(\uparrow\))</strong></th>
      <th><strong>CT OOD (\(\uparrow\))</strong></th>
      <th><strong>\(\bar{Q}\) ID (\(\downarrow\))</strong></th>
      <th><strong>\(\bar{Q}\) OOD (\(\downarrow\))</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>QL (Bourdelle et al., 2007)</td>
      <td>3D</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>89.53 ± 11.76</td>
      <td>95.22 ± 21.57</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td><strong><em>Tabular regressors</em></strong></td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>GPR (Hornsby, 2024)</td>
      <td>0D</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>43.82 ± 10.84</td>
      <td>59.28 ± 17.55</td>
    </tr>
    <tr>
      <td>MLP</td>
      <td>0D</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>50.50 ± 10.79</td>
      <td>61.98 ± 18.41</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td><strong><em>Neural Surrogate Models (48 simulations)</em></strong></td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>FNO (Li et al., 2021)</td>
      <td>3D</td>
      <td>9.33 ± 0.56</td>
      <td>9.20 ± 0.58</td>
      <td>119.88 ± 13.15</td>
      <td>124.96 ± 23.27</td>
    </tr>
    <tr>
      <td>PointNet (Qi et al., 2016)</td>
      <td>5D</td>
      <td>7.33 ± 0.21</td>
      <td>7.40 ± 0.24</td>
      <td>119.93 ± 13.15</td>
      <td>125.05 ± 23.29</td>
    </tr>
    <tr>
      <td>Transolver (Wu et al., 2024)</td>
      <td>5D</td>
      <td>9.83 ± 1.40</td>
      <td>10.80 ± 1.46</td>
      <td>119.93 ± 13.15</td>
      <td>125.05 ± 23.28</td>
    </tr>
    <tr>
      <td>ViT (Dosovitskiy et al., 2021)</td>
      <td>5D</td>
      <td>16.83 ± 1.49</td>
      <td>19.20 ± 1.36</td>
      <td>119.63 ± 13.13</td>
      <td>125.13 ± 23.29</td>
    </tr>
    <tr>
      <td>GyroSwin</td>
      <td>5D</td>
      <td>26.50 ± 3.55</td>
      <td>28.60 ± 8.82</td>
      <td>67.68 ± 10.28</td>
      <td>70.48 ± 17.21</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td><strong><em>Scaling GyroSwin to 241 simulations</em></strong></td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>GyroSwin (small)</td>
      <td>5D</td>
      <td>98.00 ± 27.53</td>
      <td>76.40 ± 17.60</td>
      <td>23.72 ± 4.05</td>
      <td>53.54 ± 18.10</td>
    </tr>
    <tr>
      <td>GyroSwin (medium)</td>
      <td>5D</td>
      <td>94.17 ± 21.96</td>
      <td>91.20 ± 18.61</td>
      <td>37.24 ± 9.60</td>
      <td>44.17 ± 17.68</td>
    </tr>
    <tr>
      <td>GyroSwin (large)</td>
      <td>5D</td>
      <td><strong>110.33 ± 19.74</strong></td>
      <td><strong>111.80 ± 23.86</strong></td>
      <td><strong>18.35 ± 1.56</strong></td>
      <td><strong>26.43 ± 9.49</strong></td>
    </tr>
  </tbody>
</table>

<p><br />
<br /></p>

<h3 id="scalability">Scalability</h3>

<p>In integrated plasma simulations, turbulent heat fluxes must be repeatedly computed across thousands of runs, radial locations, and time intervals, underscoring the need for scalable surrogate architectures. The baselines we compared to in the table above lack this capability due to different reasons: (i) Convolution-based (CNN, FNO) require factorized implementations in 5D that are memory and time intensive, (ii) field-based methods (Transolver, PointNet) suffer from subsampling during training and chunked inference, (iii) vanilla ViTs suffer from quadratic complexity. Since GyroSwin is based on linear attention, we can scale it to train on 241 simulations which amounts to over 6TB of data. We observe intriguing scaling laws, indicated by a steady decrease in loss for increasing model sizes.</p>

<figure style="text-align: center;">
    <img src="/assets/img/gyroswin/gyroswin_scaling.png" alt="GyroSwin scaling laws" width="100%" />
    <figcaption style="color: black; font-size: 14px; margin-top: 8px;">
    Figure 5: Scaling GyroSwin to 1B parameters trained on 241 simulations amounting to approximately 6TB of data. We show train/validation error for predicting the 5D distribution function (left) and the 3D electrostatic potential field (right). Loss steadily decreases with model scale.
    </figcaption>
</figure>

<h3 id="does-gyroswin-capture-underlying-physics">Does GyroSwin capture underlying physics?</h3>

<p>Diagnostics are useful to assess whether a surrogate model accurately represents the underlying physics. One such diagnostic is the turbulence intensity spectrum \(W(k_y)\), which shows what modes in \(k_y\) contribute most to turbulence.</p>

<p>We visualize this spectrum for all neural surrogates and the QL model in the left figure below. We observe that while all neural surrogates decently reproduce the shape of the spectrum, they heavily underestimate the magnitude. Furthermore, GyroSwin matches shape and magnitude almost perfectly, except for a slight discrepancy for a few higher frequency components. We attribute this finding to the spectral bias of neural networks towards lower frequency (higher energy) modes [<a href="#ref-spectral_bias">16</a>]</p>

<p>Another intriguing nonlinear phenomena are zonal flows. They arise naturally with emerging turbulence in a plasma and regulate the system to reach a statistically steady state. They are only captured in the nonlinear term of gyrokinetics, therefore QL models cannot model them. However, they play a vital role in turbulence simulation as their amplitude determines the strength of emerging turbulence.</p>

<p>We can investigate whether GyroSwin is capable of capturing such zonal flows as they are represented as an isolated mode in the \(k_y\) dimension. The right figure below shows the profile, time-averaged for an <strong>OOD</strong> case, as well as GyroSwin’s prediction thereof. As we can see the zonal flow profile aligns very well with the ground-truth, indicating that GyroSwin indeed captures nonlinear physics.</p>

<figure style="text-align: center;">
    <img src="/assets/img/gyroswin/kyspec_zf.png" alt="GyroSwin captures physics" width="100%" />
    <figcaption style="color: black; font-size: 14px; margin-top: 8px;">
    <p>Figure 6: <strong>Left:</strong> Turbulence-intensity spectrum \(W(k_y)\) averaged over time and OOD simulations for different 5D neural surrogates. Competitors tend to underestimate while GyroSwin matches the spectrum well with a slight discrepancy on higher frequencies. <strong>Right:</strong> Time-averaged zonal flow profile for a slice along \(s\) across radial coordinates \(x\) for a selected OOD simulation. GyroSwin captures the zonal flow profile.</p>

    </figcaption>
</figure>

<h1 id="wrapping-up">Wrapping up</h1>

<p>GyroSwin outperforms reduced numerical approaches and other neural surrogates in modelling plasma turbulence. It accurately captures nonlinear phenomena and spectral quantities self-consistently, while offering a speedup of three orders of magnitude compared to the numerical solver GKW [<a href="#ref-gyrokinetics3">7</a>]. Furthermore, GyroSwin scales favorably to larger amounts of data and model sizes compared to competitors, which is imperative to truly advance surrogate modelling to higher fidelity plasma turbulence simulations. As a result, GyroSwin offers a fruitful alternative to reduced numerical models for efficient approximation of turbulent transport. Finally, plasma turbulence modelling is an incredibly hard problem, but we believe that Machine Learning will disrupt the landscape of plasma turbulence modelling in the future.</p>

<figure style="text-align: center;">
    <img src="/assets/img/gyroswin/here_to_help.jpg" alt="xkcd 1831: here to help (edited)" width="100%" />
    <figcaption style="color: white; font-size: 14px; margin-top: 8px;">
    xkcd: 1831
    </figcaption>
</figure>

<h2 id="resources">Resources</h2>

<ul>
  <li><a href="https://arxiv.org/abs/2510.07314">Paper</a></li>
  <li><a href="https://github.com/ml-jku/neural-gyrokinetics">Code</a></li>
</ul>

<h2 id="citation">Citation</h2>

<p>If you found our work useful, please consider citing it.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  @inproceedings{paischer2025gyroswin,
    author       = {Fabian Paischer and Gianluca Galletti
                    and William Hornsby and Paul Setinek
                    and Lorenzo Zanisi and Naomi Carey
                    and Stanislas Pamela and Johannes Brandstetter
                },
    booktitle    = {Advances in Neural Information Processing Systems 38: Annual Conference
                  on Neural Information Processing Systems 2025, NeurIPS 2025, San Diego,
                  CA, USA, December 02 - 07, 2025},
    year         = {2025}
  }
</code></pre></div></div>

<h2 id="references">References</h2>
<p><a name="ref-chen"></a>
[1] Francis F. Chen, <em>Introduction to Plasma Physics and Controlled Fusion</em>, 3rd ed., Springer, 2016.</p>

<p><a name="ref-freudenrich"></a>
[2] Craig Freudenrich, “Physics of Nuclear Fusion Reactions,” <em>HowStuffWorks</em>, Aug. 4, 2015. [Online]. Available: <a href="http://science.howstuffworks.com/fusion-reactor1.html">http://science.howstuffworks.com/fusion-reactor1.html</a></p>

<p><a name="ref-tokamaks"></a>
[3] J. Wesson, <em>Tokamaks</em>, 4th ed., Oxford University Press, 2011.</p>

<p><a name="ref-inertial"></a>
[4] S. Atzeni and J. Meyer-ter-Vehn, <em>The Physics of Inertial Fusion: Beam Plasma Interaction, Hydrodynamics, Hot Dense Matter</em>, Oxford University Press, 2004.</p>

<p><a name="ref-gyrokinetics"></a>
[5] A. G. Peeters et al., <em>The non-linear gyro-kinetic flux tube code GKW</em>, Computer Physics Communications, 180(12), 2650–2672, 2009.</p>

<p><a name="ref-gyrokinetics2"></a>
[6] E. A. Frieman and L. Chen, “Nonlinear gyrokinetic equations for low-frequency electromagnetic waves in general plasma equilibria,” <em>Phys. Fluids</em>, vol. 25, no. 3, pp. 502–508, Mar. 1982.</p>

<p><a name="ref-gyrokinetics3"></a>
[7] X. Garbet and M. Lesur, <em>Gyrokinetics</em>, Lecture notes, France, Feb. 2023. [Online]. Available: https://hal.science/hal-03974985</p>

<p><a name="ref-pic"></a>
[8] C. K. Birdsall and A. B. Langdon, <em>Plasma Physics via Computer Simulation</em>, Taylor &amp; Francis, 2004.</p>

<p><a name="ref-fokker-planck"></a>
[9] H. Risken, <em>The Fokker-Planck Equation: Methods of Solution and Applications</em>, 2nd ed., Springer, 1989.</p>

<p><a name="ref-qualikiz"></a>
[10] A. Casati, J. Citrin, C. Bourdelle, et al., “QuaLiKiz: A fast quasilinear gyrokinetic transport model,” <em>Computer Physics Communications</em>, vol. 254, p. 107295, 2020.</p>

<p><a name="ref-cnn"></a>
[11] Y. LeCun, Y. Bengio, and G. Hinton, “Deep learning,” <em>Nature</em>, vol. 521, pp. 436–444, 2015.</p>

<p><a name="ref-attention"></a>
[12] A. Vaswani, N. Shazeer, N. Parmar, et al., “Attention Is All You Need,” in <em>Advances in Neural Information Processing Systems (NeurIPS)</em>, 2017.</p>

<p><a name="ref-vit"></a>
[13] A. Dosovitskiy, L. Beyer, A. Kolesnikov, et al., “An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale,” in <em>International Conference on Learning Representations (ICLR)</em>, 2021.</p>

<p><a name="ref-swin"></a>
[14] Z. Liu, Y. Lin, Y. Cao, et al., “Swin Transformer: Hierarchical Vision Transformer using Shifted Windows,” in <em>Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV)</em>, 2021, pp. 10012–10022.</p>

<p><a name="ref-unet"></a>
[15] O. Ronneberger, P. Fischer, and T. Brox, “U-Net: Convolutional Networks for Biomedical Image Segmentation,” in <em>Medical Image Computing and Computer-Assisted Intervention (MICCAI)</em>, 2015, pp. 234–241.</p>

<p><a name="ref-spectral_bias"></a>
[16] Nasim Rahaman, Aristide Baratin, Devansh Arpit, Felix Draxler, Min Lin, Fred A. Hamprecht, Yoshua Bengio, and Aaron C. Courville. On the spectral bias of neural networks. Proceedings of the 36th International Conference on Machine Learning, ICML 2019, 9-15 June 2019, Long Beach, California, USA, volume 97 of Proceedings of Machine Learning Research, pp. 5301–5310. PMLR, 2019.</p>

<hr />
<p>2025, Gianluca Galletti, Fabian Paischer</p>

  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2025 Institute for Machine Learning @ JKU.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

<!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>


</html>
